<?xml version="1.0" encoding="utf-8"?>
<html MadCap:lastBlockDepth="4" MadCap:lastHeight="2581.88" MadCap:lastWidth="767" xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd">
    <head><title mt-export-translate="no">Exchange Web Services</title>
        <meta name="mt-type" value="application/x.deki-text" />
        <meta name="mt-unsafe" value="false" />
    </head>
    <body>
        <h1 class="mt-export-title">Exchange Web Services</h1>
        <p class="mt-script-comment">Page summary display</p> <pre class="script" mt-export-translate="no" xml:space="preserve">
template('MindTouch/Controls/PageOverview');</pre> <p><span>Exchange Web Services Usage in MeetingPlanner</span></p> <pre class="script-css" mt-export-translate="no" xml:space="preserve">
.columbia-article-topic #mt-toc-container {
    display:block !important; 
}
#mt-toc-container {
    display: block !important;
}

</pre> <h1>Introduction</h1> <p>This document covers MeetingPlanner’s use of EWS and impersonation.&#160; For additional, up-to-date information, please see the footnotes, which reference the relevant Microsoft knowledge articles for each topic.</p> <h1>Exchange Web Services (EWS)<a class="external" name="_ftnref1" title=""><span><span><span>[1]</span></span></span></a></h1> <p>There are two ways for third-parties to interact with Exchange: MAPI and Exchange Web Services (EWS).&#160; This document will cover the latter, which is the primary avenue for MeetingPlanner to interact with Exchange from the application server.&#160;</p> <p>While developers are given the ability to interact directly with EWS, MeetingPlanner uses Microsoft’s own EWS Managed API, which is Microsoft’s recommended interface for interacting with EWS.&#160;</p> <h1>Impersonation<a class="external" name="_ftnref2" title=""><span><span><span>[2]</span></span></span></a></h1> <p>Exchange provides two methods to provide permissions within Exchange, allowing one account to interact with multiple mailboxes: Delegate and Impersonation.&#160; Generally speaking, delegate permissions are provided to users, giving them access to a few other users’ mailboxes, while impersonation is provided to a service account in order to provide access to a large number of users’ mailboxes.&#160; With the exception of select functions used in MeetingPlanner digital signage, all EWS interaction requires impersonation permissions.</p> <p>Impersonation ultimately provides “Send as” permissions, which means that the account is able to interact with Exchange as though they are the other user account.&#160; For example, a service account would be able to “impersonate” Joe User’s account in order to interact with his calendar.&#160; An invitation could be sent to other users, and those users would see the invitation as though it came directly from Joe User.&#160; This is in direct contrast to delegate permissions, which, in the same scenario, would result in the invited users receiving an invitation from the service account with a note that the account was acting on behalf of Joe User.</p> <p>It is also important to note that impersonation is something that can only be enacted through code.&#160; If a profile was made for the service account in Outlook, no permissions would be able to be enacted as impersonation has no effect in Outlook.&#160; This adds another layer of safety, and supports Microsoft’s design intentions of providing impersonation for exclusive use by service accounts.&#160;</p> <p>Impersonation is provided by granting the ApplicationImpersonation role to the service account.&#160; These permissions can be limited to a management scope, if desired.&#160; For MeetingPlanner, the service account will need permissions to all users that may interact with MeetingPlanner.<a class="external" name="_ftnref3" title=""><span><span>[3]</span></span></a></p> <h1>Accessing EWS</h1> <p>As was mentioned earlier, MeetingPlanner utilizes the Microsoft Managed API library.<a class="external" href="file://fs01/home/shauna.kopp/Networkfileshare/Products/MP Family - MeetingPlanner &amp; Web Scheduler/Exchange Web Services Usage in MeetingPlanner.docx#_ftn4" name="_ftnref4" title=""><span><span>[4]</span></span></a>&#160; The library is responsible for sending information down the wire and receiving the response.&#160; This allows all information to be sent securely, via Microsoft’s own best practices.</p> <p>Based on the standard setup, which requires an https EWS url, all communications occur via an SSL.&#160; MeetingPlanner will also validate the SSL certificate prior to creating a connection.&#160; (As may be required in certain test environments, there is an option to disable this SSL check:&#160; Suite &gt; Menu &gt; Integrations &gt; EWS &gt; Ignore SSL Errors).</p> <h1>MeetingPlanner Applications Requiring EWS</h1> <p>The applications that make use of an EWS connection are displayed below, along with the specific functions that require the connection.</p> <ul> <li>EWS is required to display user availability in the Web Scheduler.&#160; The current user is impersonated and attendee availability will be displayed based on that user’s level of permissions to the other users’ calendars.&#160; This is an optional function, which means that the Web Scheduler will continue to work without an EWS connection (this function simply wouldn’t work).</li> <li>EWS is required for the Appointment Notifier service to run successfully.&#160; This service is responsible for relaying actions taken in the Web Scheduler to the user’s Exchange calendar.&#160;</li> <li>EWS is required for MeetingPlanner digital signage, if Exchange is the desired backend connection.&#160; For full functionality, delegate “Read” access to all resource mailboxes is also required.</li></ul> <div>&#160; <hr align="left" size="1" style="width: 33%;" /> <div id="ftn1"> <p><a class="external" name="_ftn1" title=""><span><span>[1]</span></span></a><a class="link-https" href="https://msdn.microsoft.com/en-us/library/office/dd877012(v=exchg.150).aspx" rel="freeklink" title="https://msdn.microsoft.com/en-us/library/office/dd877012(v=exchg.150).aspx">https://msdn.microsoft.com/en-us/lib...xchg.150).aspx</a></p></div> <div id="ftn2"> <p><a class="external" name="_ftn2" title=""><span><span>[2]</span></span></a><a class="link-https" href="https://msdn.microsoft.com/en-us/library/office/dn722377(v=exchg.150).aspx" rel="freeklink" title="https://msdn.microsoft.com/en-us/library/office/dn722377(v=exchg.150).aspx">https://msdn.microsoft.com/en-us/lib...xchg.150).aspx</a>.&#160;</p></div> <div id="ftn3"> <p><a class="external" name="_ftn3" title=""><span><span>[3]</span></span></a><a class="link-https" href="https://msdn.microsoft.com/en-us/library/office/dn722377(v=exchg.150).aspx" rel="freeklink" title="https://msdn.microsoft.com/en-us/library/office/dn722377(v=exchg.150).aspx">https://msdn.microsoft.com/en-us/lib...xchg.150).aspx</a></p></div> <div id="ftn4"> <p><a class="external" name="_ftn4" title=""><span><span>[4]</span></span></a><a class="link-https" href="https://msdn.microsoft.com/en-us/library/office/dd633680%28v=exchg.80%29.aspx" rel="freeklink" title="https://msdn.microsoft.com/en-us/library/office/dd633680%28v=exchg.80%29.aspx">https://msdn.microsoft.com/en-us/lib...chg.80%29.aspx</a></p></div></div><hr class="mt-export-separator" /><p class="template:tag-insert"><strong>Page tags: </strong><a mt-export-translate="no">article:topic</a><a>Web Scheduler - EWS</a><a>Exchange Web Services</a><a>Impersonation</a><a>Accessing EWS</a><a mt-export-translate="no">persona:UserFacilitiesMgr</a></p></body>
</html>