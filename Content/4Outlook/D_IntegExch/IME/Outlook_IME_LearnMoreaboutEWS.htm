<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" xml:lang="en-us">
    <head><title></title>
    </head>
    <body>
        <h1 class="Title1">Learning More About Exchange Web Services (EWS) Impersonation</h1>
        <p>EMS offers two Exchange integration options to enable seamless room, resource, and attendance scheduling:</p>
        <ol start="1" class="ol_1">
            <li class="ListParagraph"><span class="Strong">EMS Integration to Exchange&#160;</span>offers users the convenience of scheduling rooms, resources, and services, confirming attendee availability,&#160;and managing Outlook invitations via EMS Web App (our web-based reservation tool).&#160;<br /><a href="https://success.emssoftware.com/Learn_About_Our_Applications/Learn_About_Managing_EMS/What_is_Integration_to_Exchange%3F" title="Knowledge_Base/IT_FAQs/What_is_Integration_to_Exchange%3f"><span class="Strong_1">See Also: Installation Overview</span></a></li>
            <li class="ListParagraph"><span class="Strong">EMS for Outlook</span>&#160;lets users find available rooms, review their details, reserve them and book any necessary resources (equipment, etc.) without ever leaving Microsoft® Outlook.</li>
        </ol>
        <p>To achieve this seamless interaction between everyday users, Outlook hosts, and EMS administrators, an account with Exchange impersonation access to all mailboxes in your Exchange mailbox store is required.</p>
        <p><a href="https://msdn.microsoft.com/en-us/library/office/dn722377(v=exchg.150).aspx" class="Hyperlink_3">See Also:&#160;Impersonation and&#160;EWS in Exchange</a>
        </p>
        <h2 class="Heading2">FAQs&#160;</h2>
        <p class="Strong">Why is this account necessary?</p>
        <p>Meetings created via EMS Integration for Exchange either on EMS Web App or EMS for Outlook are owned by the host and associated with a specific Exchange account. That Exchange user can move, update, or cancel the event. However, these meetings can also&#160;be moved, changed, or canceled by IT admins and expert users in EMS Desktop Client. When a reservation is moved, changed or canceled in the client, EMS must be able to update the record on the host’s Exchange account. Co-ownership of events between the meeting host and the EMS administrators necessitates an account that can read and write to all Exchange accounts being used for booking.</p>
        <p class="mt-font-size-110pt_1">What do we lose if we don't allow impersonation?</p>
        <p class="mt-font-size-110pt_2">Without the impersonation account turned on, you can only make "hanger "reservations from EMS for Outlook: meetings made in EMS for Outlook will be locked in EMS Web App and EMS Desktop Client.</p>
        <p><span class="mt-font-size-110pt_1">Can we exclude people from impersonation?&#160;</span><span class="mt-font-size-110pt_2">&#160;(For example, remove CEO, Board of Directors, etc. from being impersonated.)</span>
        </p>
        <p><span class="mt-font-size-110pt_2">Microsoft Exchange Server supports a&#160;</span><span class="Emphasis_2">CustomRecipientScope</span><span class="mt-font-size-110pt_2">&#160;parameter when defining the impersonation role. You can define a scope of included users by implementing this parameter.</span>
        </p>
        <p class="mt-font-size-110pt_1">Is there any way that we could use a delegation feature (like allowing office admins delegate rights) instead of impersonation to notify hosts of updates/changes?</p>
        <p class="mt-font-size-110pt_2">Delegation is possible, here are some things you should know:</p>
        <ul class="ul_1">
            <li class="mt-font-size-110pt_1">The account needs Editor w/Folder owner (so a custom rights set).</li>
            <li class="mt-font-size-110pt_1">Custom rights, at least through exchange 2010, are not scriptable. This means the delegation account will get set to owner, which is the only built in (read scriptable) option that has all the necessary permissions.</li>
            <li class="mt-font-size-110pt_1">EMS for Outlook creates a custom property on the Calendar folder, which allows you to programmatically search the folder for items that have the custom property.&#160;Once that custom property is created, then Editor will&#160;be enough. It is the creation of the custom property at the folder level that requires owner permission.&#160;&#160;</li>
            <li class="mt-font-size-110pt_1">While you can use PowerShell to script the permissions and loop through the users and set the permissions (owner), you would need to make sure that the script got applied to any new users and reapplied to any users that have changed the permissions of the delegation account</li>
            <li class="mt-font-size-110pt_1">Rights are granted to ANY mail client (Outlook, OWA, etc):&#160; when using the impersonation account, rights are only granted to Exchange Web Services, so nobody could type in the service account into Outlook and gain the same permissions.</li>
            <li class="mt-font-size-110pt_1">These rights are visible to the end user. For example, if an account, "EMSExchangeAccount", has been granted, delegation rights (any level) to User1’s calendar, and&#160;User1 goes to the Permissions tab of his calendar, he will see the EMSExchangeAccount and the rights it is assigned. Additionally, User1 would be able to change the rights, which would essentially disable&#160;the Exchange integration.</li>
            <li class="mt-font-size-110pt_1">This restricts&#160;access only to the calendar</li>
        </ul>
        <p>By contrast, EWS&#160;impersonation provides the following alternatives to delegation:</p>
        <ul class="ul_1">
            <li class="mt-font-size-110pt_1">Allows access ONLY through Exchange Web Services</li>
            <li class="mt-font-size-110pt_1">Does grant permission to do anything the impersonated user could do (assuming it is available as part of EWS)</li>
            <li class="mt-font-size-110pt_1">End users do not see (and cannot change) the permissions</li>
        </ul>
        <h2 class="Heading2">Additional Reading&#160;</h2>
        <p>The links below provide additional information from Microsoft®&#160;about Exchange Web Services (EWS).</p>
        <ul class="ul_1">
            <li class="ListParagraph_1"><a href="https://blogs.msdn.microsoft.com/webdav_101/2012/06/27/the-importance-of-ews-impersonation-while-using-an-application-account/" title="https://blogs.msdn.microsoft.com/webdav_101/2012/06/27/the-importance-of-ews-impersonation-while-using-an-application-account/" class="Strong_1">The Importance of EWS Impersonation</a>
            </li>
            <li class="ListParagraph_1"><a href="https://msdn.microsoft.com/en-us/library/office/dn626019(v=exchg.150).aspx" title="https://msdn.microsoft.com/en-us/library/office/dn626019(v=exchg.150).aspx" class="Strong_1">Authentication and EWS in Exchange</a>
            </li>
            <li class="ListParagraph_1"><a href="https://msdn.microsoft.com/en-us/library/office/dn722377(v=exchg.150).aspx" title="https://msdn.microsoft.com/en-us/library/office/dn722377(v=exchg.150).aspx"><span class="Hyperlink_4">Impersonation and EWS in Exchange&#160;</span></a>
                <br /><span class="mt-font-calibri">With Impersonation, a service account has full access to a defined set of mailboxes. What it can access in those mailboxes (such as specific folders) cannot be filtered or defined.&#160;Only an Exchange Admin can configure an EWS Impersonation account for impersonation and configure its mailboxes to allow the impersonation.</span>
            </li>
            <li class="ListParagraph_1"><a href="https://msdn.microsoft.com/en-us/library/office/dn641957(v=exchg.150).aspx" title="https://msdn.microsoft.com/en-us/library/office/dn641957(v=exchg.150).aspx"><span class="Hyperlink_4">Delegate Access and EWS in Exchange</span></a>
                <br /><span class="mt-font-calibri">Delegate access allows a user to access&#160;certain folders in another user’s mailbox &#160;Delegate permissions&#160;can be set by a mailbox owner or administrator using an app or other app code.&#160;</span>
            </li>
        </ul>
        <p>&#160;</p>
    </body>
</html>